var __isNavigating=!1,componentCache=[];window.$insecureEval=eval,window.Planifolia={routerFetchPage:()=>{var path=window.location.hash.replace("#/","");if(window.path="/"+path.replace(/^\//,""),window.pathAndQuery=window.path,""==path&&(path="index",window.location.href="#/"),path.includes("?")){let querystring=path.substring(path.indexOf("?"));window.query=window.Planifolia.parseQuery(querystring),path=path.substring(0,path.indexOf("?")),window.path=window.path.substring(0,window.path.indexOf("?")),""==path&&(path="index")}else window.query={};var basePath=window.PlanifoliaSettings.basePath??"/view/",routerFile=window.location.origin+basePath+path+".html";window.locationFile=routerFile,void 0!==window.Planifolia.onNavigating&&window.Planifolia.onNavigating(),__isNavigating=!0;let delay=window.PlanifoliaSettings.delayNavigation??0;setTimeout(()=>{fetch(routerFile).then(res=>res.text()).then(text=>{window.PlanifoliaSettings.container.innerHTML=text,window.Planifolia.fetchComponents(window.PlanifoliaSettings.container)})},delay)},fetchComponents:()=>{var exts=window.PlanifoliaSettings.container.querySelectorAll("include");if(0==exts.length)return __isNavigating&&void 0!==window.Planifolia.onNavigated&&window.Planifolia.onNavigated(),void(__isNavigating=!1);exts.forEach(async e=>{let name=e.getAttribute("name"),componentUrl=window.location.origin+"/view/"+name+".html",text="";null==componentCache[componentUrl]?(text=await fetch(componentUrl).then(res=>{if(res.ok)return res.text();throw new Error(`Cannot fetch include ${name}.`)}),componentCache[componentUrl]=text):text=componentCache[componentUrl];for(const attr of e.attributes){let attrName=attr.name,attrValue=attr.value;if(!attrName.startsWith("@"))continue;attrName=attrName.substr(1);const attrRgx=new RegExp("(?<!@)@"+attrName+"\\b","gi");text=text.replace(attrRgx,attrValue)}null!=e.parentNode&&(e.outerHTML=text),window.Planifolia.fetchElements(),window.Planifolia.fetchComponents()})},fetchElements:()=>{window.PlanifoliaSettings.container.querySelectorAll("script").forEach(s=>{s.remove();try{window.$insecureEval(s.innerText)}catch(e){throw e}}),(window.PlanifoliaSettings.autoRewriteLinks??1)&&window.PlanifoliaSettings.container.querySelectorAll("a").forEach(e=>{let href=e.getAttribute("href");href.startsWith("/")&&!href.startsWith("/#/")&&e.setAttribute("href","/#"+href)})},parseQuery:queryString=>{for(var query={},pairs=("?"===queryString[0]?queryString.substr(1):queryString).split("&"),i=0;i<pairs.length;i++){var pair=pairs[i].split("=");query[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1]||"")}return query},initializeAutoRouter:()=>{window.addEventListener("hashchange",(function(){window.Planifolia.routerFetchPage()})),window.Planifolia.routerFetchPage()}};